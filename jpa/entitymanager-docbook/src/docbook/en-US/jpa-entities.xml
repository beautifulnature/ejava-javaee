<!DOCTYPE partintro PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd"  [ ]>

<chapter id="jpa-entities">
    <title>Entities</title>
    
    <section id="jpa-entities-class">
        <title>Entity Class</title>
        <itemizedlist>
            <listitem><para>Must be annotated with the Entity annotation or denoted in the XML descriptor as entity</para></listitem>
            <listitem><para>Must have a public or protected no-arg constructor</para></listitem>
            <listitem><para>Must be a top-level class</para>
                <itemizedlist>
                    <listitem><para>Enums and interfaces cannot not be designated as entity</para></listitem>
                </itemizedlist>                   
            </listitem> 
            <listitem><para>Must not be final class</para></listitem> 
            <listitem><para>Methods or persistent instance variables must not be final</para></listitem>
        </itemizedlist>                   
        <programlisting language=""><![CDATA[
        ]]></programlisting>
    </section>


    <section id="jpa-entity-state">
        <title>Entity States</title>
        
        <section id="jpa-entity-state-attached">
            <title>Managed</title>
            <itemizedlist>
                <listitem><para>Associated with persistence context</para></listitem>
                <listitem><para>Has identity</para></listitem>
                <listitem><para>Changes to the entity will impact the database</para></listitem>
                <listitem><para>Method <code>em.contains(entity)</code> returns true</para></listitem>
            </itemizedlist>                   
        </section>

        <section id="jpa-entity-state-detached">
            <title>Detached</title>
            <itemizedlist>
                <listitem><para>Has identity but not associated with persistence context</para></listitem>
                <listitem><para>Changes to entity will not impact the database</para></listitem>
                <listitem><para>Method <code>em.contains(entity)</code> returns false</para></listitem>
                <listitem><para>An entity becomes detached when:</para>
                    <itemizedlist>
                        <listitem><para>Has not yet been persisted</para></listitem>
                        <listitem><para>After a transaction-scoped transaction is committed</para></listitem>
                        <listitem><para>After a transaction rollback</para></listitem>
                        <listitem><para>Manually detaching entity from persistence context thru <code>em.detach()</code></para></listitem>
                        <listitem><para>Manually clearing the persistence context thru <code>em.clear()</code></para></listitem>
                        <listitem><para>Closing EntityManager</para></listitem>
                        <listitem><para>Serializing entity thru a remote interface</para></listitem>
                    </itemizedlist>                   
                </listitem>
            </itemizedlist>                   
        </section>

                      
    </section>

</chapter>
  
