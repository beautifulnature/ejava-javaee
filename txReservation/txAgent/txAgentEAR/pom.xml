<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <parent>
        <artifactId>txAgent</artifactId>
        <groupId>ejava.javaee.txreservation</groupId>
        <version>2.0.2012.1-SNAPSHOT</version>
    </parent>

    <modelVersion>4.0.0</modelVersion>
    <artifactId>txAgentEAR</artifactId>
    <packaging>ear</packaging>
    <name>Tx Agent Business EAR</name>

    <dependencies>
        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>txAgentEJB</artifactId>
            <version>${project.version}</version>
            <type>ejb</type>
            <exclusions>
                <exclusion>
                    <artifactId>commons-logging</artifactId>
                    <groupId>commons-logging</groupId>
                </exclusion>
                <exclusion>
                    <groupId>${project.groupId}</groupId>
                    <artifactId>txHotelBLImpl</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>${project.groupId}</groupId>
                    <artifactId>txHotelDAO</artifactId>
                </exclusion>
                <!-- un-comment these when using a shared unified classloader
                     with txHotel; however, make sure to undeploy this application
                     when updating txHotel since it will be using the classes 
                <exclusion>
                    <artifactId>txHotelEJB</artifactId>
                    <groupId>${project.groupId}</groupId>
                </exclusion>
                <exclusion>
                    <artifactId>txHotelBO</artifactId>
                    <groupId>${project.groupId}</groupId>
                </exclusion>
                     -->
            </exclusions>
        </dependency>
    </dependencies>

<profiles>
    <!-- this profiles allow the EAR to be undeployed before it is deleted
        during the clean target. This behavior requires the EAR to be
        present, so it cannot be part of the default behavior. It is
        only activated when -Dundeploy or -Pundeploy is present so that
        normal cleans do not fail.  -->
<profile>
    <id>undeploy</id>
    <activation>
        <property>
            <name>undeploy</name>
            <value>true</value>
        </property>
    </activation>    
    <build>
        <plugins>
            <plugin>
                <groupId>org.codehaus.cargo</groupId>
                <artifactId>cargo-maven2-plugin</artifactId>
                <configuration>
                    <deployer>
                        <type>remote</type>
                        <deployables>
                            <deployable>
                                <groupId>${project.groupId}</groupId>
                                <artifactId>${project.artifactId}</artifactId>
                                <type>ear</type>
                            </deployable>
                        </deployables>
                    </deployer>
                </configuration>
                <executions>
                    <execution>
                        <id>undeploy-ear</id>
                        <phase>pre-clean</phase>
                        <goals>
                            <goal>undeploy</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>                    
        </plugins>
    </build>
</profile>
    </profiles>
</project>
